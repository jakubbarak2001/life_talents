<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Talent Tree - Journaling</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <article>
        <header class="talent-header">
            <div class="talent-header-image"></div>
            <div class="talent-header-text">Journaling</div>
        </header>
        <section>
    <div class="talent-grid-journal">
        <svg class="talent-lines" viewBox="0 0 450 750">
            <line x1="375" y1="184" x2="375" y2="375" class="line-locked" />
            <line x1="75" y1="375" x2="75" y2="471" class="line-locked" />
            <line x1="175" y1="375" x2="175" y2="566" class="line-locked" />
        </svg>

        <div class="talent-node t1-1" data-current="0" data-max="5">
            <div class="icon"></div><span class="rank">0/5</span>
            <div class="tooltip">
                <h3>Improved Vocabulary</h3>
                <p>Increases available vocabulary by 5%.</p>
                <span class="science-text">Writing activates the frontotemporal network, enhancing lexical retrieval and structural complexity.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t1-2" data-current="0" data-max="3">
            <div class="icon"></div><span class="rank">0/3</span>
            <div class="tooltip">
                <h3>The Habit Loop</h3>
                <p>Reduces the Willpower Cost of initiating a session by 10%.</p>
                <span class="science-text">Routine repetition bypasses the prefrontal cortex, anchoring behavior in the basal ganglia.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t1-3" data-current="0" data-max="5">
            <div class="icon"></div><span class="rank">0/5</span>
            <div class="tooltip">
                <h3>Mental Declutter</h3>
                <p>Reduces the impact of intrusive thoughts by 5%.</p>
                <span class="science-text">Offloading internal data to an external medium significantly reduces cognitive load and intrusive interference.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t1-4" data-current="0" data-max="3">
            <div class="icon"></div><span class="rank">0/3</span>
            <div class="tooltip">
                <h3>Anxiety Buffer</h3>
                <p>Reduces daily anxiety symptoms by 7%.</p>
                <span class="science-text">Labeling emotions in text decreases amygdala reactivity via the ventrolateral prefrontal cortex.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t2-1" data-current="0" data-max="3">
            <div class="icon"></div><span class="rank">0/3</span>
            <div class="tooltip">
                <h3>Emotional Processing</h3>
                <p>Clarifies chaotic emotional states, reducing confusion by 8%.</p>
                <span class="science-text">Expressive writing facilitates cognitive reappraisal, fostering habituation to negative emotional stimuli.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t2-2" data-current="0" data-max="3">
            <div class="icon"></div><span class="rank">0/3</span>
            <div class="tooltip">
                <h3>Cognitive RAM</h3>
                <p>Expands working memory capacity 10%.</p>
                <span class="science-text">Externalizing data releases working memory capacity, improving general executive functioning.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t2-3" data-current="0" data-max="3">
            <div class="icon"></div><span class="rank">0/3</span>
            <div class="tooltip">
                <h3>Problem Solver</h3>
                <p>Enhances the ability to identify solutions for blocks by 12%.</p>
                <span class="science-text">Translating abstract thoughts into concrete text identifies logical inconsistencies and cognitive biases.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t2-4" data-current="0" data-max="1">
            <div class="icon"></div><span class="rank">0/1</span>
            <div class="tooltip">
                <h3>Narrative Resilience</h3>
                <p>Strengthens personal story, reducing stress impact by 15%.</p>
                <span class="science-text">Constructing a coherent self-narrative is strongly correlated with increased psychological hardiness.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t3-1" data-current="0" data-max="3">
            <div class="icon"></div><span class="rank">0/3</span>
            <div class="tooltip">
                <h3>Pattern Seeker</h3>
                <p>Grants a 15% chance to automatically identify emotional triggers.</p>
                <span class="science-text">Metacognitive tracking enhances the detection of recurring affective states and environmental triggers.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t3-2" data-current="0" data-max="1">
            <div class="icon"></div><span class="rank">0/1</span>
            <div class="tooltip">
                <h3>Gratitude Resilience</h3>
                <p>Increases baseline daily happiness and stability by 10%.</p>
                <span class="science-text">Positive reflection increases dopamine release and neural activity in the medial prefrontal cortex.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t4-1" data-current="0" data-max="2">
            <div class="icon"></div><span class="rank">0/2</span>
            <div class="tooltip">
                <h3>Insight Synthesis</h3>
                <p>Combines reflections into wisdom with 20% increased efficiency.</p>
                <span class="science-text">Reflective synthesis promotes neuroplasticity in areas associated with meaning-making and wisdom.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t4-2" data-current="0" data-max="5">
            <div class="icon"></div><span class="rank">0/5</span>
            <div class="tooltip">
                <h3>Trauma Integration</h3>
                <p>Facilitates resolution of past stressors, improving clarity by 5%.</p>
                <span class="science-text">Narrative disclosure facilitates physiological habituation and reduces long-term autonomic arousal.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t4-4" data-current="0" data-max="3">
            <div class="icon"></div><span class="rank">0/3</span>
            <div class="tooltip">
                <h3>Perspective Shift</h3>
                <p>Allows for re-framing experiences, increasing flexibility by 15%.</p>
                <span class="science-text">Psychological distancing through writing increases cognitive flexibility and reduces emotional reactivity.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t5-1" data-current="0" data-max="2">
            <div class="icon"></div><span class="rank">0/2</span>
            <div class="tooltip">
                <h3>Mindful Awareness</h3>
                <p>Increases presence and clarity throughout the process by 25%.</p>
                <span class="science-text">Sustained journaling functions as a focused-attention task, enhancing neural presence and regulation.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>

        <div class="talent-node t6-2" data-current="0" data-max="1">
            <div class="icon"></div><span class="rank">0/1</span>
            <div class="tooltip">
                <h3>Architect of the Ascended Self</h3>
                <p>Empowers the Scribe to become the lead Architect of their existence. You gain the ability to Rewrite Your Narrative in real-time, transmuting past traumas and future fears into controllable Plot Devices. Increases Intentionality by 100%.</p>
                <span class="science-text">Long-term journaling (12+ months) produces a state of "High Narrative Coherence." This neurological landmark represents the point where the brainâ€™s autobiographical memory and executive control are perfectly aligned, allowing the individual to bypass old reactive patterns and consciously curate their personality and life direction.</span>
                <span class="learn-text">Click to learn</span>
                <span class="unlearn-text" style="display: none;">Right click to unlearn</span>
            </div>
        </div>
    </div>
    </section>
</article>
    <script>
        async function fetchTalentData() {
    try {
        const response = await fetch('http://127.0.0.1:8000/api/talents');
        if (!response.ok) {
            throw new Error('Kitchen is not responding!');
        }
        const data = await response.json();
        console.log("Data received from Kitchen:", data);

        // For now, we just log it to prove the connection works.
        return data;
    } catch (error) {
        console.error("Connection failed:", error);
    }
}

// Call the function to test the connection immediately
fetchTalentData();

        document.querySelectorAll('.talent-node').forEach(node => {
            node.addEventListener('click', () => {
                if (node.classList.contains('locked')) return;
                let current = parseInt(node.getAttribute('data-current'));
                let max = parseInt(node.getAttribute('data-max'));
                if (current < max) {
                    current++;
                    updateNode(node, current, max);
                    checkUnlocks(); 
                }
            });

            node.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                let current = parseInt(node.getAttribute('data-current'));
                let max = parseInt(node.getAttribute('data-max'));
                if (current > 0) {
                    current--;
                    updateNode(node, current, max);
                    checkUnlocks(); 
                }
            });
        });

        function updateNode(node, current, max) {
            node.setAttribute('data-current', current);
            node.querySelector('.rank').innerText = `${current}/${max}`;
            const unlearnTxt = node.querySelector('.unlearn-text');
            const learnTxt = node.querySelector('.learn-text');

            if (current > 0) {
                node.classList.add('learned');
                unlearnTxt.style.display = 'block';
            } else {
                node.classList.remove('learned');
                unlearnTxt.style.display = 'none';
            }
            learnTxt.style.display = (current === max) ? 'none' : 'block';
        }

        function checkUnlocks() {
            // 1. Calculate TOTAL points spent in the tree
            let totalSpent = 0;
            document.querySelectorAll('.talent-node').forEach(n => {
                totalSpent += parseInt(n.getAttribute('data-current'));
            });

            // 2. Define Row thresholds (WoW style)
            // Row 1: 0 points | Row 2: 5 points | Row 3: 10 points, etc.
            const rowThresholds = {
                't1': 0,
                't2': 5,
                't3': 10,
                't4': 15,
                't5': 20,
                't6': 25
            };

            // 3. Loop through every node and check its row against the totalSpent
            document.querySelectorAll('.talent-node').forEach(node => {
                // This grabs the "t1" or "t2" part of the class list
                const rowClass = node.classList[1].substring(0, 2); 
                const required = rowThresholds[rowClass];

                if (totalSpent >= required) {
                    node.classList.remove('locked');
                } else {
                    // Only lock it if they haven't put points in it yet
                    if (parseInt(node.getAttribute('data-current')) === 0) {
                        node.classList.add('locked');
                    }
                }
            });
        }

        checkUnlocks(); // Initialize the tree
    </script>

</body>
</html>